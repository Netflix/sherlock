<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Cross-Validated Doubly Robust Pseudo-Outcome Transformation — cv_dr_transform • sherlock</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Cross-Validated Doubly Robust Pseudo-Outcome Transformation — cv_dr_transform" />
<meta property="og:description" content="Generation of the doubly robust pseudo-outcome required for estimation of
the conditional average treatment effect (CATE) based upon a transformation
using the form of the efficient influence function (EIF; a key quantity in
semiparametric statistics) of the average treatment effect. Creation of the
pseudo-outcome happens within a particular cross-validation fold; however,
depending on the value of the argument split_type either the CATE is
estimated by a call to cv_fit_cate or a placeholder column for
the CATE estimate is generated. In the latter case, actual estimation of the
CATE is deferred to an optional step in est_cate, in which the
CATE is estimated on the full data." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sherlock</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/sherlock_quick_start_netflix.html">`sherlock`: Causal Machine Learning for Segment Discovery</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Cross-Validated Doubly Robust Pseudo-Outcome Transformation</h1>
    
    <div class="hidden name"><code>cv_dr_transform.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Generation of the doubly robust pseudo-outcome required for estimation of
the conditional average treatment effect (CATE) based upon a transformation
using the form of the efficient influence function (EIF; a key quantity in
semiparametric statistics) of the average treatment effect. Creation of the
pseudo-outcome happens within a particular cross-validation fold; however,
depending on the value of the argument <code>split_type</code> either the CATE is
estimated by a call to <code><a href='cv_fit_cate.html'>cv_fit_cate</a></code> or a placeholder column for
the CATE estimate is generated. In the latter case, actual estimation of the
CATE is deferred to an optional step in <code><a href='est_cate.html'>est_cate</a></code>, in which the
CATE is estimated on the full data.</p>
    </div>

    <pre class="usage"><span class='fu'>cv_dr_transform</span><span class='op'>(</span><span class='va'>fold</span>, <span class='va'>data_est_spec</span>, <span class='va'>ps_learner</span>, <span class='va'>or_learner</span>, <span class='va'>cate_learner</span>,
  <span class='va'>split_type</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>fold</th>
      <td><p>An object specifying the cross-validation folds into which the
observations fall, as generated by <code><a href='http://tlverse.org/origami/reference/make_folds.html'>make_folds</a></code>.</p></td>
    </tr>
    <tr>
      <th>data_est_spec</th>
      <td><p>An input <code><a href='https://Rdatatable.gitlab.io/data.table/reference/data.table.html'>data.table</a></code> object
created from the input data by <code><a href='set_est_data.html'>set_est_data</a></code>. Note that this
data container object has specialized attributes appended to it, so it must
be created by that internal utility function.</p></td>
    </tr>
    <tr>
      <th>ps_learner</th>
      <td><p>An instantiated learner object, with class inheriting from
<code><a href='https://tlverse.org/sl3/reference/Lrnr_base.html'>Lrnr_base</a></code>, from <span class="pkg">sl3</span>, to be used for estimation of
the propensity score (the probability of receiving treatment, conditional
on covariates). Note that the outcome of this estimation task is strictly
binary and that algorithms or ensembles should be set up accordingly.</p></td>
    </tr>
    <tr>
      <th>or_learner</th>
      <td><p>An instantiated learner object, with class inheriting from
<code><a href='https://tlverse.org/sl3/reference/Lrnr_base.html'>Lrnr_base</a></code>, from <span class="pkg">sl3</span>, to be used for estimation of
the outcome regression (the mean of the response variable, conditional on
exposure and covariates).</p></td>
    </tr>
    <tr>
      <th>cate_learner</th>
      <td><p>An instantiated learner object, with class inheriting
from <code><a href='https://tlverse.org/sl3/reference/Lrnr_base.html'>Lrnr_base</a></code>, from <span class="pkg">sl3</span>, to be used to estimate
the CATE, based on a regression of a doubly robust pseudo-outcome on the
specified segmentation covariates. Note that the outcome of this estimation
task is derived from the other nuisance parameter estimates and should be
expected to always be continuous-valued, so algorithms or ensembles should
be set up accordingly.</p></td>
    </tr>
    <tr>
      <th>split_type</th>
      <td><p>A <code>character</code> string (of length one) indicating the
sample-splitting "level" at which estimation of the CATE is performed. The
choices are "inner", for estimation of the CATE within folds (i.e., at the
the same level at which nuisance parameters are estimated), and "outer", in
which case the CATE is estimated at the "full-sample" level.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code>list</code> (as required by <code><a href='http://tlverse.org/origami/reference/cross_validate.html'>cross_validate</a></code>)
containing a <code><a href='https://Rdatatable.gitlab.io/data.table/reference/data.table.html'>data.table</a></code> of the validation sample
for the given cross-validation fold, augmented with additional columns that
specify the nuisance parameter estimates, the doubly robust pseudo-outcome,
and (possibly) the estimated CATE.</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Nima Hejazi, Wenjing Zheng, Netflix, Inc..</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


