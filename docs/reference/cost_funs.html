<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Cost Functions for Assignment of a Dynamic Treatment Rule — cost_funs • sherlock</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Cost Functions for Assignment of a Dynamic Treatment Rule — cost_funs" />
<meta property="og:description" content="Cost functions for the assignment of a dynamic treatment rule to individual
segments identified by realizations of segmentation covariate strata. These
functions are used in conjunction with assign_rule for the
assignment of a treatment rule. There are three types of cost functions:
cost_threshold, which enforces a fixed boundary for learning the
dynamic treatment rule. This cost_fun requires a given cutoff
against which to threshold the estimated CATE. Those segments with a CATE
exceeding the threshold are assigned the treatment, while the treatment
is withheld from those segments whose estimated CATE falls below.
cost_budget, which data adaptively learns a cost boundary for
assignment of a treatment rule. This cost_fun requires as input a
maximum proportion of units to receive treatment (and, optionally, any
observation-level weights), used to derive a cutoff for thresholding of
the estimated CATE. Those segments with estimated CATEs exceeding this
learned threshold are assigned treatment and others not. Note that this
procedure fails to solve the so-called knapsack problem, instead choosing
to treat those segments with the highest estimated CATEs while possibly
failing to exhaust the given budget.
cost_knapsack, which, similar to cost_budget, searches for
a cost boundary for the assigment of a treatment rule data adaptively. In
assigning segments to treatment, this routine solves the binary knapsack
problem, using the approximate combinatorial optimization routine through
knapsack. The result of this routine often mirrors
that of cost_budget, except that solving the knapsack problem
ensures that the budget is approximately exhausted.

" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sherlock</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/sherlock_quick_start_netflix.html">`sherlock`: Causal Machine Learning for Segment Discovery</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Cost Functions for Assignment of a Dynamic Treatment Rule</h1>
    
    <div class="hidden name"><code>cost_funs.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Cost functions for the assignment of a dynamic treatment rule to individual
segments identified by realizations of segmentation covariate strata. These
functions are used in conjunction with <code><a href='assign_rule.html'>assign_rule</a></code> for the
assignment of a treatment rule. There are three types of cost functions:</p><ol>
<li><p><code>cost_threshold</code>, which enforces a fixed boundary for learning the
dynamic treatment rule. This <code>cost_fun</code> requires a given cutoff
against which to threshold the estimated CATE. Those segments with a CATE
exceeding the threshold are assigned the treatment, while the treatment
is withheld from those segments whose estimated CATE falls below.</p></li>
<li><p><code>cost_budget</code>, which data adaptively learns a cost boundary for
assignment of a treatment rule. This <code>cost_fun</code> requires as input a
maximum proportion of units to receive treatment (and, optionally, any
observation-level weights), used to derive a cutoff for thresholding of
the estimated CATE. Those segments with estimated CATEs exceeding this
learned threshold are assigned treatment and others not. Note that this
procedure fails to solve the so-called knapsack problem, instead choosing
to treat those segments with the highest estimated CATEs while possibly
failing to exhaust the given budget.</p></li>
<li><p><code>cost_knapsack</code>, which, similar to <code>cost_budget</code>, searches for
a cost boundary for the assigment of a treatment rule data adaptively. In
assigning segments to treatment, this routine solves the binary knapsack
problem, using the approximate combinatorial optimization routine through
<code><a href='https://rdrr.io/pkg/adagio/man/knapsack.html'>knapsack</a></code>. The result of this routine often mirrors
that of <code>cost_budget</code>, except that solving the knapsack problem
ensures that the budget is approximately exhausted.</p></li>
</ol>

    </div>

    <pre class="usage"><span class='fu'>cost_threshold</span><span class='op'>(</span><span class='va'>data_with_cate</span>, threshold <span class='op'>=</span> <span class='fl'>0</span>, type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"inferential"</span>,
  <span class='st'>"analytic"</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'>cost_budget</span><span class='op'>(</span><span class='va'>data_with_cate</span>, <span class='va'>budget</span>, cost_weights <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>,
  <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>data_with_cate</span><span class='op'>)</span><span class='op'>)</span>, type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"inferential"</span>, <span class='st'>"analytic"</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'>cost_knapsack</span><span class='op'>(</span><span class='va'>data_with_cate</span>, <span class='va'>budget</span>, use_segment_treatment_cost <span class='op'>=</span> <span class='cn'>FALSE</span>,
  type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"inferential"</span>, <span class='st'>"analytic"</span><span class='op'>)</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data_with_cate</th>
      <td><p>A <code><a href='https://Rdatatable.gitlab.io/data.table/reference/data.table.html'>data.table</a></code> containing the
input data, augmented with cross-validated nuisance parameter estimates and
an estimate of the CATE. This input object should b ecreated by successive
calls to <code><a href='set_est_data.html'>set_est_data</a></code> and <code><a href='est_cate.html'>est_cate</a></code>, or through
a wrapper function that composes these function calls automatically, and is
passed on to the cost functions through <code><a href='assign_rule.html'>assign_rule</a></code>.</p></td>
    </tr>
    <tr>
      <th>threshold</th>
      <td><p>A <code>numeric</code> value indicating the cutoff to be used in
determining the treatment decision based on the estimated CATE. The default
of zero assigns treatment to segments that ought to benefit from treatment
while withholding treatment from those segments that ought to be harmed. It
may suit to adjust this value based on the problem context. This is used in
<code>cost_threshold</code>.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>A <code>character</code> string (of length one) specifying how the
treatment decision based on the CATE is to be made. There are two options:</p><ul>
<li><p><code>"inferential"</code> (the default) uses a hypothesis test to evaluate
whether the estimated CATE is statistically different from a threshold
and allocates a treatment decision based on the resultant p-value.</p></li>
<li><p><code>"analytic"</code> simply evaluates whether the estimated CATE exceeds a
given threshold and assigns treatment to segments for which this holds.
Note that in both cases the threshold must be either provided directly (as
an input to <code>cost_threshold</code>) or will be discovered based on
specified constraints (as in <code>cost_budget</code>).</p></li>
</ul></td>
    </tr>
    <tr>
      <th>budget</th>
      <td><p>A <code>numeric</code> indicating the proportion of units to receive
treatment. This proportion is used to discover a cutoff for thresholding of
the estimated CATE. This is used in <code>cost_budget</code>.</p></td>
    </tr>
    <tr>
      <th>cost_weights</th>
      <td><p>A <code>numeric</code> vector giving the observation-level
weights to be used in computing the cutoff for thresholding of the CATE in
<code>cost_budget</code>. By default, all units are given equal weight.</p></td>
    </tr>
    <tr>
      <th>use_segment_treatment_cost</th>
      <td><p>A <code>logical</code> indicating whether the
cost associated with treating a segment should be taken into account when
deciding which segments to treat via <code>cost_knapsack</code>. This
option defaults to <code>FALSE</code>, but if set to <code>TRUE</code>, the treatment
cost must have been specified as an attribute previously.</p></td>
    </tr>
    </table>


  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Nima Hejazi, Wenjing Zheng, Netflix, Inc..</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


